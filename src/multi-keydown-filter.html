<dom-module id="multi-keydown-filter">
    <template>
        <content on-keydown="_keyDown" on-keyup="_keyUp"></content>
    </template>
    <script>
        Polymer({
            is: 'multi-keydown-filter',
            properties: {
                _keysdown: {
                    type: Array,
                    value: function () {
                        return [];
                    }
                }
            },
            _keyDown: function (e) {
                if (this._keysdown.indexOf(e.key) === -1)
                    this._keysdown.push(e.key);
                if (this._keysdown.length === 0)
                    return;

                var res = "";
                for (var i = 0; i < this._keysdown.length; i++) {
                    var key = this._keysdown[i];
                    res = (key.length === 1) ? key + res : res + ":" + key;
                }
                this.fire("multikeydown", res);
            },
            _keyUp: function (e) {
                var i = this._keysdown.indexOf(e.key);
                this._keysdown.splice(i, 1);
                if (i == -1)
                    throw new Error("WTF is wrong with the keyboard?!");
            }
        });
    </script>
</dom-module>